var S={"Content-Type":"application/json"};function H(s={}){let{fetch:e=globalThis.fetch,querySerializer:t,bodySerializer:i,...n}=s,o=n.baseUrl??"";o.endsWith("/")&&(o=o.slice(0,-1));async function h(r,a){let{fetch:x=e,headers:R,body:O,params:F={},parseAs:d="json",querySerializer:m=t??z,bodySerializer:b=i??M,...g}=a||{},q=K(r,{baseUrl:o,params:F,querySerializer:m}),T=C(S,s?.headers,R,F.header),P={redirect:"follow",...n,...g,headers:T};O&&(P.body=b(O)),P.body instanceof FormData&&T.delete("Content-Type");let p=await x(q,P);if(p.status===204||p.headers.get("Content-Length")==="0")return p.ok?{data:{},response:p}:{error:{},response:p};if(p.ok){let y;if(d!=="stream"){let u=p.clone();y=typeof u[d]=="function"?await u[d]():await u.text()}else y=p.clone().body;return{data:y,response:p}}let c={};try{c=await p.clone().json()}catch{c=await p.clone().text()}return{error:c,response:p}}return{async GET(r,...a){return h(r,{...a[0],method:"GET"})},async PUT(r,...a){return h(r,{...a[0],method:"PUT"})},async POST(r,...a){return h(r,{...a[0],method:"POST"})},async DELETE(r,...a){return h(r,{...a[0],method:"DELETE"})},async OPTIONS(r,...a){return h(r,{...a[0],method:"OPTIONS"})},async HEAD(r,...a){return h(r,{...a[0],method:"HEAD"})},async PATCH(r,...a){return h(r,{...a[0],method:"PATCH"})},async TRACE(r,...a){return h(r,{...a[0],method:"TRACE"})}}}function z(s){let e=[];if(s&&typeof s=="object")for(let[t,i]of Object.entries(s)){let n=l([t],i);n&&e.push(n)}return e.join("&")}function l(s,e){if(e!=null){if(typeof e=="string")return`${f(s)}=${encodeURIComponent(e)}`;if(typeof e=="number"||typeof e=="boolean")return`${f(s)}=${String(e)}`;if(Array.isArray(e)){if(!e.length)return;let t=[];for(let i of e){let n=l(s,i);n!==void 0&&t.push(n)}return t.join("&")}if(typeof e=="object"){if(!Object.keys(e).length)return;let t=[];for(let[i,n]of Object.entries(e))if(n!=null){let o=l([...s,i],n);o!==void 0&&t.push(o)}return t.join("&")}return encodeURIComponent(`${f(s)}=${String(e)}`)}}function f(s){let e=s[0];for(let t of s.slice(1))e+=`[${t}]`;return e}function M(s){return JSON.stringify(s)}function K(s,e){let t=`${e.baseUrl}${s}`;if(e.params.path)for(let[n,o]of Object.entries(e.params.path))t=t.replace(`{${n}}`,encodeURIComponent(String(o)));let i=e.querySerializer(e.params.query??{});return i&&(t+=`?${i}`),t}function C(...s){let e=new Headers;for(let t of s){if(!t||typeof t!="object")continue;let i=t instanceof Headers?t.entries():Object.entries(t);for(let[n,o]of i)o===null?e.delete(n):o!==void 0&&e.set(n,o)}return e}export{K as createFinalURL,H as default,M as defaultBodySerializer,l as defaultQueryParamSerializer,z as defaultQuerySerializer,C as mergeHeaders};
